(window.webpackJsonp=window.webpackJsonp||[]).push([[14],{"9JbG":function(t,n,e){"use strict";e.r(n),e.d(n,"InventoryModule",function(){return T});var o=e("ofXK"),c=e("tyNb"),i=e("2Vo4"),r=e("itXk"),s=e("vkgz"),a=e("Kj3r"),b=e("lJxs"),u=e("1G5W"),d=e("3Pt+"),l=e("nPLa"),p=e("+Kmi"),h=e("sEf6"),m=e("fXoL"),f=e("2qjx"),y=e("x6Rh"),g=e("l7P3");function S(t,n){1&t&&m.Nb(0,"i",22)}function j(t,n){1&t&&m.Nb(0,"i",23)}function v(t,n){if(1&t){const t=m.Tb();m.Sb(0,"section"),m.Sb(1,"table",4),m.Sb(2,"thead"),m.Sb(3,"tr"),m.Sb(4,"th"),m.Ac(5," Product Name "),m.Rb(),m.Sb(6,"th"),m.Ac(7,"Product ID"),m.Rb(),m.Sb(8,"th"),m.Ac(9,"Current Quantity"),m.Rb(),m.Rb(),m.Rb(),m.Sb(10,"tbody"),m.Sb(11,"tr"),m.Sb(12,"td"),m.Ac(13),m.Rb(),m.Sb(14,"td"),m.Ac(15),m.Rb(),m.Sb(16,"td"),m.Ac(17),m.Rb(),m.Rb(),m.Rb(),m.Rb(),m.Sb(18,"form",5),m.Zb("submit",function(){return m.tc(t),m.bc(2).submitInventoryAdjustement()}),m.Sb(19,"section",6),m.Sb(20,"section",7),m.Sb(21,"section",8),m.Sb(22,"label",9),m.Ac(23,"Adjustment"),m.Rb(),m.Sb(24,"input",10),m.Zb("change",function(n){return m.tc(t),m.bc(2).onAdjustmentChange(n.target.value)}),m.Rb(),m.Rb(),m.Sb(25,"section",8),m.Sb(26,"label",11),m.Ac(27,"Final Stock Count"),m.Rb(),m.Nb(28,"input",12),m.Rb(),m.Sb(29,"section",13),m.Sb(30,"label",14),m.Ac(31,"Reason For Adjustment"),m.Rb(),m.Nb(32,"textarea",15),m.Rb(),m.Rb(),m.Sb(33,"section",16),m.Sb(34,"button",17),m.Ac(35," Save Quantity "),m.yc(36,S,1,0,"i",18),m.cc(37,"async"),m.yc(38,j,1,0,"i",19),m.cc(39,"async"),m.Rb(),m.Sb(40,"button",20),m.Zb("click",function(){return m.tc(t),m.bc(2).closeModal()}),m.Nb(41,"span",21),m.Ac(42,"Cancel"),m.Rb(),m.Rb(),m.Rb(),m.Rb(),m.Rb()}if(2&t){const t=n.ngIf,e=m.bc().ngIf,o=m.bc();m.Ab(13),m.Bc(t.name),m.Ab(2),m.Cc("#",t.id,""),m.Ab(2),m.Bc(e.inventoryQuantity),m.Ab(1),m.hc("formGroup",o.inventoryAdjustementForm),m.Ab(16),m.hc("disabled",o.inventoryAdjustementForm.invalid||!o.inventoryAdjustementForm.dirty),m.Ab(2),m.hc("ngIf",o.inventoryAdjustementForm.valid&&!1===m.dc(37,7,o.submitInProgressAction$)),m.Ab(2),m.hc("ngIf",m.dc(39,9,o.submitInProgressAction$))}}function A(t,n){if(1&t&&(m.Sb(0,"section",2),m.Sb(1,"h2"),m.Ac(2,"Edit Product Quantity"),m.Rb(),m.yc(3,v,43,11,"section",3),m.Rb()),2&t){const t=n.ngIf;m.Ab(3),m.hc("ngIf",t.product)}}function R(t,n){1&t&&(m.Sb(0,"section",2),m.Sb(1,"h2"),m.Ac(2,"Edit Product Quantity"),m.Rb(),m.Sb(3,"span",24),m.Ac(4,"Please Wait ..."),m.Rb(),m.Rb())}let w=(()=>{class t extends(Object(p.a)(Object(h.a)())){constructor(t,n,e,o){super(),this.productsService=t,this.fb=n,this.inventoryQuantityService=e,this.store=o,this.inventoryAdjustementForm=this.fb.group({adjustment:[0,[d.v.required]],finalStockCount:[0,[d.v.required]],reasonForAdjustment:["",[d.v.required]]}),this.quantityChangeSubject$=new i.a(0),this.quantityChangeAction$=this.quantityChangeSubject$.asObservable()}get adjustment(){return this.inventoryAdjustementForm.get("adjustment")}get finalStockCount(){return this.inventoryAdjustementForm.get("finalStockCount")}ngOnInit(){this.product$=this.productsService.loadProducts$.pipe(Object(b.a)(t=>t.find(({id:t})=>t===this.id))),this.inventoryQuantity$=this.inventoryQuantityService.quantityForProductWithId(this.id),this.adjustmentChange$=Object(r.a)([this.quantityChangeAction$,this.inventoryQuantity$]).pipe(Object(s.a)(([t,n])=>this.finalStockCount.setValue(n+t))),this.vm$=Object(r.a)([this.product$,this.inventoryQuantity$,this.adjustmentChange$]).pipe(Object(b.a)(([t,n])=>({product:t,inventoryQuantity:n})))}onAdjustmentChange(t){this.quantityChangeSubject$.next(+t)}closeModal(){this.store.dispatch(Object(l.a)())}submitInventoryAdjustement(){var t;this.submitInProgressSubject$.next(!0),this.inventoryQuantityService.adjustQuantity({id:this.id,adjustment:+this.adjustment.value,reason:null===(t=this.inventoryAdjustementForm.get("reasonForAdjustment"))||void 0===t?void 0:t.value}).pipe(Object(u.a)(this.destroyed$)).subscribe({next:()=>{this.submitInProgressSubject$.next(!1),this.store.dispatch(Object(l.a)())},error:()=>this.submitInProgressSubject$.next(!1)})}}return t.\u0275fac=function(n){return new(n||t)(m.Mb(f.a),m.Mb(d.d),m.Mb(y.a),m.Mb(g.h))},t.\u0275cmp=m.Gb({type:t,selectors:[["app-edit-inventory-quantity"]],inputs:{id:"id"},features:[m.xb],decls:4,vars:4,consts:[["class","bg-dark p-2",4,"ngIf","ngIfElse"],["loading",""],[1,"bg-dark","p-2"],[4,"ngIf"],[1,"table","table-dark"],[3,"formGroup","submit"],[1,"card","p-2"],[1,"d-flex","flex-wrap","align-items-end","justify-content-between"],[1,"col-lg-5"],["for","adjustment",1,"control-label"],["formControlName","adjustment","type","number","id","adjustment",1,"form-control",3,"change"],["for","finalStockCount",1,"control-label"],["formControlName","finalStockCount","readonly","","type","number","id","finalStockCount",1,"form-control"],[1,"col-lg-12","mt-2"],["for","reasonForAdjustment",1,"control-label"],["formControlName","reasonForAdjustment","id","reasonForAdjustment",1,"form-control"],[1,"card-footer","d-flex","justify-content-between"],[1,"btn","btn-success",3,"disabled"],["class","icon-ok",4,"ngIf"],["class","icon-spin3 animate-spin",4,"ngIf"],["type","button",1,"btn","btn-secondary",3,"click"],[1,"icon-cancel"],[1,"icon-ok"],[1,"icon-spin3","animate-spin"],[1,"p-4"]],template:function(t,n){if(1&t&&(m.yc(0,A,4,1,"section",0),m.cc(1,"async"),m.yc(2,R,5,0,"ng-template",null,1,m.zc)),2&t){const t=m.qc(3);m.hc("ngIf",m.dc(1,2,n.vm$))("ngIfElse",t)}},directives:[o.n,d.x,d.n,d.h,d.b,d.q,d.m,d.g],pipes:[o.b],styles:[""]}),t})();var x=e("bLFI"),I=e("CG4G");const $=(t=class{})=>class extends t{constructor(){super(...arguments),this.loadingSubject$=new i.a(!0),this.loadingAction$=this.loadingSubject$.asObservable()}};var k=e("B/gT"),C=e("K3ix"),P=e("hVnv"),O=e("oGmh"),M=e("aFxk");function L(t,n){1&t&&(m.Sb(0,"tr"),m.Sb(1,"td"),m.Nb(2,"app-loading-bubble"),m.Rb(),m.Rb())}const F=function(t){return{backgroundColor:t}},N=function(t){return{width:t}},Q=function(t){return["product",t]};function B(t,n){if(1&t){const t=m.Tb();m.Sb(0,"tr"),m.Sb(1,"td"),m.Ac(2),m.Rb(),m.Sb(3,"td"),m.Ac(4),m.cc(5,"titlecase"),m.Rb(),m.Sb(6,"td"),m.Ac(7),m.Rb(),m.Sb(8,"td"),m.Ac(9),m.Rb(),m.Sb(10,"td",14),m.Sb(11,"div",15),m.Sb(12,"div",16),m.Ac(13),m.cc(14,"number"),m.Rb(),m.Nb(15,"div",17),m.Rb(),m.Rb(),m.Sb(16,"td",11),m.Sb(17,"button",18),m.Nb(18,"span",19),m.Rb(),m.Sb(19,"button",20),m.Zb("click",function(){m.tc(t);const e=n.$implicit;return m.bc().openModal({id:e.id})}),m.Nb(20,"span",21),m.Rb(),m.Rb(),m.Rb()}if(2&t){const t=n.$implicit;m.Eb("bg-danger",t.count<0),m.Ab(2),m.Cc("#",t.id,""),m.Ab(2),m.Bc(m.dc(5,13,t.name)),m.Ab(3),m.Dc("",t.min," - ",t.max,""),m.Ab(2),m.Bc(t.count),m.Ab(3),m.xc("width",100*t.lowIndex+"%"),m.hc("ngStyle",m.kc(18,F,t.color)),m.Ab(1),m.Cc(" ",m.ec(14,15,100*t.lowIndex,"2.0-0"),"% "),m.Ab(2),m.hc("ngStyle",m.kc(20,N,100-100*t.lowIndex+"%")),m.Ab(2),m.hc("routerLink",m.kc(22,Q,t.id))}}let G=(()=>{class t extends(Object(k.a)($(Object(I.a)(Object(x.a)(Object(h.a)()))))){constructor(t,n,e,o){super(),this.productService=t,this.modalService=n,this.store=e,this.inventoryQuantityService=o,this.storeInjected=this.store,this.modalServiceInjected=this.modalService,this.sortByQuantityLowSubject$=new i.a(!1),this.sortByQuantityLowAction$=this.sortByQuantityLowSubject$.asObservable(),this.products$=this.productService.productsStockCount$,this.adjustmentsAction$=this.inventoryQuantityService.adjustmentsAction$,this.filteredProducts$=Object(r.a)([this.products$,this.filterStringAction$,this.adjustmentsAction$]).pipe(Object(s.a)(()=>this.loadingSubject$.next(!0)),Object(a.a)(500),Object(b.a)(([t,n,e])=>t.filter(t=>t.name.toLowerCase().includes(n.toLowerCase())).map(t=>Object.assign(Object.assign({},t),{count:Number(null==t?void 0:t.count)+Number((null==e?void 0:e[t.id])||0)}))),Object(b.a)(t=>t.map(t=>Object.assign(Object.assign({},t),{lowIndex:this.getProductLowPercentage(t),color:this.getProductColor(t)}))),Object(s.a)(()=>this.loadingSubject$.next(!1))),this.sortedProducts$=Object(r.a)([this.sortByQuantityLowAction$,this.filteredProducts$]).pipe(Object(b.a)(([t,n])=>n.sort(t?(t,n)=>t.lowIndex>n.lowIndex?1:t.lowIndex<n.lowIndex?-1:0:(t,n)=>t.id>n.id?1:t.id<n.id?-1:0)))}openModal({id:t}){super.openModal({id:t,component:w})}getProductLowPercentage(t){const{count:n,min:e,max:o}=t;return Math.min(n/((e+o)/2))}getProductLowIndex(t){const{count:n,min:e,max:o}=t;return Math.min(1,Math.max(0,(n-e)/(o-e)))}getProductColor(t){return this.getColorString(100*this.getProductLowIndex(t))}ngOnDestroy(){var t;super.ngOnDestroy(),null===(t=this.modalRef)||void 0===t||t.hide()}}return t.\u0275fac=function(n){return new(n||t)(m.Mb(f.a),m.Mb(C.a),m.Mb(g.h),m.Mb(y.a))},t.\u0275cmp=m.Gb({type:t,selectors:[["app-inventory-management"]],features:[m.xb],decls:33,vars:6,consts:[[1,"d-flex","flex-wrap","justify-content-between","align-items-end"],[1,"col-md-5","col-xl-5","col-lg-5","col-sm-5"],["for","searchProducts"],[1,"icon-search"],["id","searchProducts","type","search",1,"form-control",3,"keyup"],[1,"col-md-4","col-xs-4","col-lg-5","col-sm-5"],["label","Sort By Quantity Level",3,"ngModelChange"],[1,"col-xl-2","col-md-2","text-md-right","col-lg-2","text-right","mt-3"],["selector",".printable"],[1,"printable","mt-2"],[1,"table","table-sm","table-dark"],[1,"d-print-none"],[4,"ngIf"],[3,"bg-danger",4,"ngFor","ngForOf"],[2,"width","25%"],[1,"progress"],["role","progressbar",1,"progress-bar",2,"color","black","font-weight","bold",3,"ngStyle"],["role","progressbar",1,"progress-bar","progress-bar-striped","bg-secondary",3,"ngStyle"],["aria-label","Adjust Inventory",1,"btn","btn-info","btn-sm","mr-2",3,"routerLink"],[1,"icon-eye"],["aria-label","Adjust Inventory",1,"btn","btn-primary","btn-sm",3,"click"],[1,"icon-edit"]],template:function(t,n){1&t&&(m.Sb(0,"h1"),m.Ac(1,"Inventory Management"),m.Rb(),m.Sb(2,"div",0),m.Sb(3,"section",1),m.Sb(4,"label",2),m.Ac(5,"Search "),m.Nb(6,"span",3),m.Rb(),m.Sb(7,"input",4),m.Zb("keyup",function(t){return n.filterStringSubject$.next(t.target.value)}),m.Rb(),m.Rb(),m.Sb(8,"section",5),m.Sb(9,"app-checkbox",6),m.Zb("ngModelChange",function(t){return n.sortByQuantityLowSubject$.next(t)}),m.Rb(),m.Rb(),m.Sb(10,"section",7),m.Nb(11,"app-print",8),m.Rb(),m.Rb(),m.Sb(12,"section",9),m.Sb(13,"table",10),m.Sb(14,"thead"),m.Sb(15,"tr"),m.Sb(16,"th"),m.Ac(17,"Product Id"),m.Rb(),m.Sb(18,"th"),m.Ac(19,"Product Name"),m.Rb(),m.Sb(20,"th"),m.Ac(21,"Threshold"),m.Rb(),m.Sb(22,"th"),m.Ac(23,"Remaining Items"),m.Rb(),m.Sb(24,"th"),m.Ac(25,"Percentage Remaining"),m.Rb(),m.Sb(26,"th",11),m.Ac(27,"Action"),m.Rb(),m.Rb(),m.yc(28,L,3,0,"tr",12),m.cc(29,"async"),m.Rb(),m.Sb(30,"tbody"),m.yc(31,B,21,24,"tr",13),m.cc(32,"async"),m.Rb(),m.Rb(),m.Rb()),2&t&&(m.Ab(28),m.hc("ngIf",m.dc(29,2,n.loadingAction$)),m.Ab(3),m.hc("ngForOf",m.dc(32,4,n.sortedProducts$)))},directives:[P.a,O.a,o.n,o.m,M.a,o.o,c.g],pipes:[o.b,o.u,o.f],styles:[""]}),t})();const q=[{path:"",pathMatch:"full",data:{breadcrumb:null},canDeactivate:[e("wNMA").a],component:G},{path:"product",loadChildren:()=>Promise.all([e.e(3),e.e(4),e.e(0),e.e(27)]).then(e.bind(null,"LKLr")).then(t=>t.InventoryMovementManagementModule)}];let K=(()=>{class t{}return t.\u0275mod=m.Kb({type:t}),t.\u0275inj=m.Jb({factory:function(n){return new(n||t)},imports:[[c.j.forChild(q)],c.j]}),t})();var Z=e("RecK"),X=e("HEfn"),E=e("jdGB"),J=e("IVO7"),D=e("B3RB");let T=(()=>{class t{}return t.\u0275mod=m.Kb({type:t}),t.\u0275inj=m.Jb({factory:function(n){return new(n||t)},imports:[[o.c,K,Z.a,d.j,d.s,C.b.forRoot(),X.a,E.a,J.a,D.a]]}),t})()},B3RB:function(t,n,e){"use strict";e.d(n,"a",function(){return i});var o=e("ofXK"),c=e("fXoL");let i=(()=>{class t{}return t.\u0275mod=c.Kb({type:t}),t.\u0275inj=c.Jb({factory:function(n){return new(n||t)},imports:[[o.c]]}),t})()},CG4G:function(t,n,e){"use strict";e.d(n,"a",function(){return o});const o=(t=class{})=>class extends t{getColorString(t){return["hsl(",Math.floor(120*t/100),",100%,50%)"].join("")}}},aFxk:function(t,n,e){"use strict";e.d(n,"a",function(){return c});var o=e("fXoL");let c=(()=>{class t{constructor(){}ngOnInit(){}}return t.\u0275fac=function(n){return new(n||t)},t.\u0275cmp=o.Gb({type:t,selectors:[["app-loading-bubble"]],decls:4,vars:0,consts:[["role","status",1,"spinner-grow"],[1,"sr-only"]],template:function(t,n){1&t&&(o.Sb(0,"div",0),o.Sb(1,"span",1),o.Ac(2,"Loading..."),o.Rb(),o.Rb(),o.Ac(3,"\nPlease wait..."))},styles:[""]}),t})()},bxdZ:function(t,n,e){"use strict";e.d(n,"a",function(){return c});var o=e("fXoL");let c=(()=>{class t{constructor(){}popupPrint(t){const n=document.querySelector(t).innerHTML,e=window.open("","_blank","top=0,left=0,height=auto,width=auto");null==e||e.document.open(),null==e||e.document.write(`\n      <html>\n        <head>\n          <title>Print tab</title>\n          <style>\n            .d-flex  {\n              width: 100%;\n              display: flex;\n              justify-content: between;\n            }\n            .table {\n              text-align: left;\n              width: 100%;\n              margin-bottom: 1rem;\n            }\n            .table td, .table th {\n              padding: .75rem;\n              vertical-align: top;\n              border-top: 1px solid #dee2e6;\n            }\n            td {\n              display: table-cell;\n            }\n            @media print {\n              .d-print-none {\n                display: none;\n              }\n            }\n          </style>\n        </head>\n        <body>\n          <section class='d-print-none'>\n            <button onclick="window.print();">Print</button>\n            <button onclick="window.close();">Cancel</button>\n          </section>\n         ${n}\n        </body>\n        <script>\n          window.print();\n        <\/script>\n      </html>`)}}return t.\u0275fac=function(n){return new(n||t)},t.\u0275prov=o.Ib({token:t,factory:t.\u0275fac,providedIn:"root"}),t})()},oGmh:function(t,n,e){"use strict";e.d(n,"a",function(){return i});var o=e("fXoL"),c=e("bxdZ");let i=(()=>{class t{constructor(t){this.printService=t}print(){this.printService.popupPrint(this.selector)}}return t.\u0275fac=function(n){return new(n||t)(o.Mb(c.a))},t.\u0275cmp=o.Gb({type:t,selectors:[["app-print"]],inputs:{selector:"selector"},decls:3,vars:0,consts:[["type","button",1,"btn","btn-secondary","btn-sm",3,"click"],[1,"icon-print"]],template:function(t,n){1&t&&(o.Sb(0,"button",0),o.Zb("click",function(){return n.print()}),o.Ac(1,"Print "),o.Nb(2,"span",1),o.Rb())},styles:[""]}),t})()}}]);