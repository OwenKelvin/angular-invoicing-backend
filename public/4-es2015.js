(window.webpackJsonp=window.webpackJsonp||[]).push([[4],{"/SgV":function(e,t,r){"use strict";r.d(t,"b",function(){return s}),r.d(t,"d",function(){return i}),r.d(t,"c",function(){return n}),r.d(t,"a",function(){return a}),r.d(t,"e",function(){return u});var c=r("l7P3");const s=Object(c.n)("[Purchase] Load Purchases"),i=Object(c.n)("[Purchase] Load Purchases Success",Object(c.s)()),n=Object(c.n)("[Purchase] Load Purchases Failure",Object(c.s)()),a=Object(c.n)("[Purchase] Delete Purchase",Object(c.s)()),u=Object(c.n)("[Purchase] Delete Purchase",Object(c.s)())},"0WHi":function(e,t,r){"use strict";r.d(t,"a",function(){return n}),r.d(t,"b",function(){return a});var c=r("l7P3"),s=r("eY9e");const i=Object(c.o)(s.b),n=Object(c.q)(i,e=>{var t;return null===(t=Object.values(e||{}))||void 0===t?void 0:t.filter(e=>0!==e.id)}),a=({id:e})=>Object(c.q)(i,t=>t[e])},HW8q:function(e,t,r){"use strict";r.d(t,"a",function(){return R});var c=r("3Pt+"),s=r("nPLa"),i=r("vkgz"),n=r("1G5W"),a=r("/SgV"),u=r("sEf6"),o=r("+Kmi"),d=r("fXoL"),b=r("l7P3"),l=r("mkJD"),p=r("2qjx"),h=r("ChtM"),m=r("gWX1"),f=r("ZOsW"),S=r("ofXK"),g=r("dZIy"),O=r("QlUG");function j(e,t){if(1&e&&(d.Sb(0,"ng-option",31),d.Ac(1),d.cc(2,"titlecase"),d.Rb()),2&e){const e=t.$implicit;d.hc("value",e.id),d.Ab(1),d.Cc(" ",d.dc(2,2,e.name)," ")}}function y(e,t){if(1&e){const e=d.Tb();d.Sb(0,"li",34),d.Zb("click",function(){d.tc(e);const r=t.$implicit;return d.bc(2).purchaseCurrency.setValue(r)}),d.Sb(1,"span",35),d.Ac(2),d.Rb(),d.Rb()}if(2&e){const e=t.$implicit;d.Ab(2),d.Bc(e)}}function v(e,t){if(1&e&&(d.Sb(0,"ul",32),d.yc(1,y,3,1,"li",33),d.cc(2,"async"),d.Rb()),2&e){const e=d.bc();d.Ab(1),d.hc("ngForOf",d.dc(2,1,e.currencies$))}}function P(e,t){1&e&&d.Nb(0,"i",36)}function I(e,t){1&e&&d.Nb(0,"i",37)}let R=(()=>{class e extends(Object(o.a)(Object(u.a)())){constructor(e,t,r,s,i,n){super(),this.store=e,this.fb=t,this.purchaseService=r,this.productsService=s,this.currencyService=i,this.sellerService=n,this.currencies$=this.currencyService.loadCurrencies$,this.sellers$=this.sellerService.loadSellers$,this.purchaseForm=this.fb.group({id:[0],productId:[null,[c.v.required]],quantityPurchased:[1,[c.v.required]],unitPrice:[null,[c.v.required]],sellerId:[0],purchaseCurrency:["KES",[c.v.required]],purchaseDate:[null,[c.v.required]]}),this.products$=this.productsService.loadProducts$}ngOnInit(){this.purchase$=this.purchaseService.getPurchaseWithId(this.id).pipe(Object(i.a)(e=>this.purchaseForm.patchValue(e))),this.store.dispatch(Object(s.b)()),this.purchase$.subscribe()}closeModal(){this.itemForm=this.purchaseForm,this.closeFormDialog()&&this.store.dispatch(Object(s.a)())}purchaseFormSubmit(){this.purchaseForm.valid&&(this.submitInProgressSubject$.next(!0),this.purchaseService.savePurchase(this.purchaseForm.value).pipe(Object(n.a)(this.destroyed$)).subscribe({next:e=>{this.submitInProgressSubject$.next(!1),this.store.dispatch(Object(s.a)()),this.store.dispatch(Object(a.e)({data:e}))},error:()=>this.submitInProgressSubject$.next(!1)}))}get purchaseCurrency(){return this.purchaseForm.get("purchaseCurrency")}}return e.\u0275fac=function(t){return new(t||e)(d.Mb(b.h),d.Mb(c.d),d.Mb(l.a),d.Mb(p.a),d.Mb(h.a),d.Mb(m.a))},e.\u0275cmp=d.Gb({type:e,selectors:[["app-purchase-maintenance"]],inputs:{id:"id"},features:[d.xb],decls:50,vars:16,consts:[[1,"bg-dark"],[3,"formGroup","submit"],[1,"card"],[1,"card-header"],[1,"card-body"],[1,"d-flex","flex-wrap"],[1,"col-lg-6","mt-3"],["for","product",1,"control-label"],["placeholder","Choose a Product","id","product","formControlName","productId"],["role","option",3,"value",4,"ngFor","ngForOf"],["for","seller",1,"control-label"],["placeholder","Choose a Seller","id","seller","bindLabel","name","bindValue","id","formControlName","sellerId",3,"items"],["for","purchaseBuyingPrice",1,"control-label"],[1,"input-group","mb-3"],[1,"input-group-prepend"],["dropdown","",1,"btn-group"],["type","button",1,"btn","bg-light","text-dark"],["id","button-split","type","button","dropdownToggle","","aria-controls","dropdown-split",1,"btn","bg-light","text-dark","dropdown-toggle","dropdown-toggle-split"],[1,"caret"],[1,"sr-only"],["id","dropdown-split","class","dropdown-menu","role","menu","aria-labelledby","button-split",4,"dropdownMenu"],["placeholder","Enter Price e.g 50.00","id","purchaseBuyingPrice","formControlName","unitPrice","type","number",1,"form-control"],["label","Quantity","placeholder","Enter Quantity eg 50","id","quantityPurchased","formControlName","quantityPurchased"],["for","purchaseDate"],["id","purchaseDate","type","date","formControlName","purchaseDate",1,"form-control"],[1,"card-footer","d-flex","justify-content-between"],[1,"btn","btn-success",3,"disabled"],["class","icon-ok",4,"ngIf"],["class","icon-spin3 animate-spin",4,"ngIf"],["type","button",1,"btn","btn-secondary",3,"click"],[1,"icon-cancel"],["role","option",3,"value"],["id","dropdown-split","role","menu","aria-labelledby","button-split",1,"dropdown-menu"],["role","menuitem",3,"click",4,"ngFor","ngForOf"],["role","menuitem",3,"click"],[1,"dropdown-item"],[1,"icon-ok"],[1,"icon-spin3","animate-spin"]],template:function(e,t){1&e&&(d.Sb(0,"section",0),d.Sb(1,"form",1),d.Zb("submit",function(){return t.purchaseFormSubmit()}),d.Sb(2,"section",2),d.Sb(3,"section",3),d.Sb(4,"h2"),d.Ac(5),d.Rb(),d.Rb(),d.Sb(6,"section",4),d.Sb(7,"section",5),d.Sb(8,"section",6),d.Sb(9,"label",7),d.Ac(10,"Product"),d.Rb(),d.Sb(11,"ng-select",8),d.yc(12,j,3,4,"ng-option",9),d.cc(13,"async"),d.Rb(),d.Rb(),d.Sb(14,"section",6),d.Sb(15,"label",10),d.Ac(16,"Seller"),d.Rb(),d.Nb(17,"ng-select",11),d.cc(18,"async"),d.Rb(),d.Sb(19,"section",6),d.Sb(20,"label",12),d.Ac(21,"Unit Price"),d.Rb(),d.Sb(22,"div",13),d.Sb(23,"div",14),d.Sb(24,"div",15),d.Sb(25,"button",16),d.Ac(26),d.Rb(),d.Sb(27,"button",17),d.Nb(28,"span",18),d.Sb(29,"span",19),d.Ac(30,"Change Currency"),d.Rb(),d.Rb(),d.yc(31,v,3,3,"ul",20),d.Rb(),d.Rb(),d.Nb(32,"input",21),d.Rb(),d.Rb(),d.Sb(33,"section",6),d.Nb(34,"app-input",22),d.Rb(),d.Sb(35,"section",6),d.Sb(36,"label",23),d.Ac(37,"Purchase Date"),d.Rb(),d.Sb(38,"section"),d.Nb(39,"input",24),d.Rb(),d.Rb(),d.Rb(),d.Rb(),d.Sb(40,"section",25),d.Sb(41,"button",26),d.Ac(42," Save "),d.yc(43,P,1,0,"i",27),d.cc(44,"async"),d.yc(45,I,1,0,"i",28),d.cc(46,"async"),d.Rb(),d.Sb(47,"button",29),d.Zb("click",function(){return t.closeModal()}),d.Nb(48,"span",30),d.Ac(49,"Cancel"),d.Rb(),d.Rb(),d.Rb(),d.Rb(),d.Rb()),2&e&&(d.Ab(1),d.hc("formGroup",t.purchaseForm),d.Ab(4),d.Cc("",0===t.id?"New":"Edit"," Purchase"),d.Ab(7),d.hc("ngForOf",d.dc(13,8,t.products$)),d.Ab(5),d.hc("items",d.dc(18,10,t.sellers$)),d.Ab(9),d.Bc(t.purchaseCurrency.value),d.Ab(15),d.hc("disabled",t.purchaseForm.invalid||!t.purchaseForm.dirty),d.Ab(2),d.hc("ngIf",t.purchaseForm.valid&&!1===d.dc(44,12,t.submitInProgressAction$)),d.Ab(2),d.hc("ngIf",d.dc(46,14,t.submitInProgressAction$)))},directives:[c.x,c.n,c.h,f.a,c.m,c.g,S.m,g.a,g.d,g.b,c.b,c.q,O.a,S.n,f.c],pipes:[S.b,S.u],styles:[""]}),e})()},RTvA:function(e,t,r){"use strict";r.d(t,"a",function(){return m});var c=r("3Pt+"),s=r("l7P3"),i=r("nPLa"),n=r("z1kL"),a=r("GJmQ"),u=r("/SgV"),o=r("fXoL"),d=r("mkJD"),b=r("ofXK");function l(e,t){if(1&e&&(o.Sb(0,"section"),o.Sb(1,"table",15),o.Sb(2,"thead"),o.Sb(3,"tr"),o.Sb(4,"th"),o.Ac(5,"Purchase ID"),o.Rb(),o.Sb(6,"th"),o.Ac(7,"Purchase Name"),o.Rb(),o.Sb(8,"th"),o.Ac(9,"Quantity"),o.Rb(),o.Rb(),o.Sb(10,"tr"),o.Sb(11,"td"),o.Ac(12),o.Rb(),o.Sb(13,"td"),o.Ac(14),o.Rb(),o.Sb(15,"td"),o.Ac(16),o.cc(17,"currency"),o.Rb(),o.Rb(),o.Rb(),o.Rb(),o.Rb()),2&e){const e=t.ngIf;o.Ab(12),o.Cc("#",e.id,""),o.Ab(2),o.Bc(e.productName),o.Ab(2),o.Dc("",e.quantityPurchased," units @ ",o.ec(17,4,e.unitPrice,e.purchaseCurrency+" "),"")}}function p(e,t){1&e&&o.Nb(0,"i",16)}function h(e,t){1&e&&o.Nb(0,"i",17)}let m=(()=>{class e{constructor(e,t,r){this.store=e,this.purchaseService=t,this.fb=r,this.purchaseForm=this.fb.group({id:[""]}),this.componentIsActive=!0,this.validateId=e=>t=>t.value==="#"+e?null:{idMismatch:"Id Mismatch"}}ngOnInit(){var e;this.store.dispatch(Object(i.b)()),this.purchase$=this.store.pipe(Object(s.t)(Object(n.b)({id:this.id})),Object(a.a)(()=>this.componentIsActive)),null===(e=this.purchaseForm.get("id"))||void 0===e||e.setValidators([c.v.required,this.validateId(this.id)])}closeModal(){this.store.dispatch(Object(i.a)())}purchaseFormSubmit(){this.purchaseForm.valid&&(this.isSubmitting=!0,this.purchaseService.deletePurchase(this.id).pipe(Object(a.a)(()=>this.componentIsActive)).subscribe({next:()=>{this.isSubmitting=!1,this.closeModal(),this.store.dispatch(Object(u.a)({data:{id:this.id}}))},error:()=>this.isSubmitting=!1}))}ngOnDestroy(){this.componentIsActive=!1}}return e.\u0275fac=function(t){return new(t||e)(o.Mb(s.h),o.Mb(d.a),o.Mb(c.d))},e.\u0275cmp=o.Gb({type:e,selectors:[["app-delete-purchase-confirmation"]],inputs:{id:"id"},decls:21,vars:7,consts:[[1,"bg-dark"],[3,"formGroup","submit"],[1,"card"],[1,"card-header"],[4,"ngIf"],[1,"col-lg-12","mt-3","mb-2","d-flex"],["for","idConfirmation",1,"col-lg-6"],[1,"col-lg-6"],["id","idConfirmation","type","text","formControlName","id","placeholder","e.g #1234",1,"form-control"],[1,"card-footer","d-flex","justify-content-between"],[1,"btn","btn-danger",3,"disabled"],["class","icon-trash",4,"ngIf"],["class","icon-spin3 animate-spin",4,"ngIf"],["type","button",1,"btn","btn-secondary",3,"click"],[1,"icon-cancel"],[1,"table","table-dark"],[1,"icon-trash"],[1,"icon-spin3","animate-spin"]],template:function(e,t){1&e&&(o.Sb(0,"section",0),o.Sb(1,"form",1),o.Zb("submit",function(){return t.purchaseFormSubmit()}),o.Sb(2,"section",2),o.Sb(3,"section",3),o.Sb(4,"h2"),o.Ac(5,"Delete Purchase Confirmation"),o.Rb(),o.Rb(),o.yc(6,l,18,7,"section",4),o.cc(7,"async"),o.Sb(8,"section",5),o.Sb(9,"label",6),o.Ac(10,"Please Enter Purchase Id To Confirm Deletion"),o.Rb(),o.Sb(11,"section",7),o.Nb(12,"input",8),o.Rb(),o.Rb(),o.Sb(13,"section",9),o.Sb(14,"button",10),o.Ac(15," Delete Purchase "),o.yc(16,p,1,0,"i",11),o.yc(17,h,1,0,"i",12),o.Rb(),o.Sb(18,"button",13),o.Zb("click",function(){return t.closeModal()}),o.Nb(19,"span",14),o.Ac(20,"Cancel"),o.Rb(),o.Rb(),o.Rb(),o.Rb(),o.Rb()),2&e&&(o.Ab(1),o.hc("formGroup",t.purchaseForm),o.Ab(5),o.hc("ngIf",o.dc(7,5,t.purchase$)),o.Ab(8),o.hc("disabled",t.purchaseForm.invalid||!t.purchaseForm.dirty),o.Ab(2),o.hc("ngIf",t.purchaseForm.valid&&!t.isSubmitting),o.Ab(1),o.hc("ngIf",t.isSubmitting))},directives:[c.x,c.n,c.h,b.n,c.b,c.m,c.g],pipes:[b.b,b.d],styles:[""]}),e})()},ckED:function(e,t,r){"use strict";r.d(t,"a",function(){return i}),r.d(t,"b",function(){return a});var c=r("l7P3"),s=r("/SgV");const i="purchases",n={0:{id:0,productId:null,productName:"",quantityPurchased:null,unitPrice:null,sellerId:null,sellerName:"",purchaseCurrency:"KES",purchaseDate:(new Date).toISOString().substring(0,10)}},a=Object(c.p)(n,Object(c.r)(s.b,e=>e),Object(c.r)(s.d,(e,t)=>{const r={};return t.data.forEach(e=>{r[e.id]=e}),Object.assign({},r)}),Object(c.r)(s.c,e=>e),Object(c.r)(s.a,(e,t)=>{const r=Object.assign({},e);return delete r[t.data.id],r}),Object(c.r)(s.e,(e,t)=>Object.assign(Object.assign({},e),{[t.data.id]:t.data})))},e6Kq:function(e,t,r){"use strict";r.d(t,"a",function(){return c});const c=(e=class{})=>class extends e{getDate(e){e.setHours(-e.getTimezoneOffset()/60,0,0);const[t,r,c]=e.toISOString().split("-");return`${t}-${r}-${c.substr(0,2)}`}}},eY9e:function(e,t,r){"use strict";r.d(t,"b",function(){return i}),r.d(t,"a",function(){return n});var c=r("l7P3"),s=r("m8bv");const i="sellers",n=Object(c.p)({0:{id:0,name:"",description:""}},Object(c.r)(s.b,e=>e),Object(c.r)(s.d,(e,t)=>{const r={};return t.data.forEach(e=>{r[e.id]=e}),Object.assign(Object.assign({},e),r)}),Object(c.r)(s.c,e=>e),Object(c.r)(s.a,(e,t)=>{const r=Object.assign({},e);return delete r[t.data.id],r}))},gWX1:function(e,t,r){"use strict";r.d(t,"a",function(){return d});var c=r("l7P3"),s=r("lJxs"),i=r("vkgz"),n=r("m8bv"),a=r("0WHi"),u=r("fXoL"),o=r("tk/3");let d=(()=>{class e{constructor(e,t){this.store=e,this.http=t,this.sellersLoaded=!1,this.sellers$=this.http.get("api/sellers").pipe(Object(s.a)(e=>e.map(e=>({id:e.id,name:e.name,description:e.description}))),Object(i.a)(()=>this.sellersLoaded=!0)),this.loadSellers$=this.store.pipe(Object(c.t)(a.a),Object(i.a)(({length:e})=>e<1&&!this.sellersLoaded?this.store.dispatch(Object(n.b)()):""))}deleteSeller(e){return this.http.delete(`api/sellers/${e}`)}saveSeller(e){let t=`api/sellers/${e.id}`;return 0===e.id?(t="api/sellers",this.http.post(t,{description:e.description,name:e.name}).pipe(Object(s.a)(e=>e.data),Object(s.a)(e=>({id:e.id,name:e.name,description:e.description})))):this.http.post(t,{_method:"PATCH",description:e.description,name:e.name}).pipe(Object(s.a)(e=>e.data),Object(s.a)(e=>({id:e.id,name:e.name,description:e.description})))}}return e.\u0275fac=function(t){return new(t||e)(u.Wb(c.h),u.Wb(o.b))},e.\u0275prov=u.Ib({token:e,factory:e.\u0275fac,providedIn:"root"}),e})()},m8bv:function(e,t,r){"use strict";r.d(t,"b",function(){return s}),r.d(t,"d",function(){return i}),r.d(t,"c",function(){return n}),r.d(t,"a",function(){return a});var c=r("l7P3");const s=Object(c.n)("[Seller] Load Sellers"),i=Object(c.n)("[Seller] Load Sellers Success",Object(c.s)()),n=Object(c.n)("[Seller] Load Sellers Failure",Object(c.s)()),a=Object(c.n)("[Seller] Delete Seller",Object(c.s)())},mkJD:function(e,t,r){"use strict";r.d(t,"a",function(){return b});var c=r("l7P3"),s=r("/SgV"),i=r("lJxs"),n=r("vkgz"),a=r("z1kL"),u=r("e6Kq"),o=r("fXoL"),d=r("tk/3");let b=(()=>{class e extends(Object(u.a)()){constructor(e,t){super(),this.store=e,this.http=t,this.url="api/purchases",this.purchaseDates$=this.http.get(`${this.url}/?purchase_dates=true`),this.purchasesLoaded=!1,this.purchases$=this.http.get(this.url).pipe(Object(i.a)(e=>e.map(e=>({id:e.id,productId:e.product_id,productName:e.product_name,quantityPurchased:e.quantity,sellerId:e.seller_id,sellerName:e.seller_name,unitPrice:e.unit_price,purchaseCurrency:e.currency,purchaseDate:e.purchase_date}))),Object(n.a)(()=>this.purchasesLoaded=!0)),this.loadPurchases$=this.store.pipe(Object(c.t)(a.a),Object(n.a)(({length:e})=>e<1&&!this.purchasesLoaded?this.store.dispatch(Object(s.b)()):"")),this.getPurchasesForDate$=e=>this.http.get(`${this.url}/?purchase_date=${this.getDate(e)}`).pipe(Object(i.a)(this.mappedPurchases)),this.mappedPurchase=e=>({id:e.id,productId:e.product_id,productName:e.product_name,quantityPurchased:e.quantity,sellerId:e.seller_id,sellerName:e.seller_name,unitPrice:e.unit_price,purchaseCurrency:e.currency,purchaseDate:e.purchase_date}),this.mappedPurchases=e=>e.map(e=>({id:e.id,productId:e.product_id,productName:e.product_name,quantityPurchased:e.quantity,sellerId:e.seller_id,sellerName:e.seller_name,unitPrice:e.unit_price,purchaseCurrency:e.currency,purchaseDate:e.purchase_date})),this.getPurchaseWithId=e=>this.http.get(`${this.url}/${e}`).pipe(Object(i.a)(this.mappedPurchase))}deletePurchase(e){return this.http.delete(`${this.url}/${e}`)}savePurchase(e){let t=`${this.url}/${e.id}`;return 0===e.id?(t="api/purchases",this.http.post(t,{product_id:e.productId,quantity:e.quantityPurchased,seller_id:e.sellerId,unit_price:e.unitPrice,currency:e.purchaseCurrency,purchase_date:e.purchaseDate}).pipe(Object(i.a)(e=>e.data),Object(i.a)(e=>({id:e.id,productId:e.product_id,productName:e.product_name,quantityPurchased:e.quantity,sellerId:e.seller_id,sellerName:e.seller_name,unitPrice:e.unit_price,purchaseCurrency:e.currency,purchaseDate:e.purchase_date})))):this.http.post(t,{_method:"PATCH",product_id:e.productId,quantity:e.quantityPurchased,seller_id:e.sellerId,unit_price:e.unitPrice,currency:e.purchaseCurrency,purchase_date:e.purchaseDate}).pipe(Object(i.a)(e=>e.data),Object(i.a)(e=>({id:e.id,productId:e.product_id,productName:e.product_name,quantityPurchased:e.quantity,sellerId:e.seller_id,sellerName:e.seller_name,unitPrice:e.unit_price,purchaseCurrency:e.currency,purchaseDate:e.purchase_date})))}}return e.\u0275fac=function(t){return new(t||e)(o.Wb(c.h),o.Wb(d.b))},e.\u0275prov=o.Ib({token:e,factory:e.\u0275fac,providedIn:"root"}),e})()},x6dL:function(e,t,r){"use strict";r.d(t,"a",function(){return m});var c=r("ofXK"),s=r("l7P3"),i=r("9jGm"),n=r("bOdf"),a=r("lJxs"),u=r("JIr8"),o=r("LRne"),d=r("m8bv"),b=r("fXoL"),l=r("gWX1");let p=(()=>{class e{constructor(e,t){this.actions$=e,this.sellerService=t,this.loadSellers$=Object(i.c)(()=>this.actions$.pipe(Object(i.d)(d.b),Object(n.a)(()=>this.sellerService.sellers$.pipe(Object(a.a)(e=>d.d({data:e})),Object(u.a)(e=>Object(o.a)(d.c({error:e})))))))}}return e.\u0275fac=function(t){return new(t||e)(b.Wb(i.a),b.Wb(l.a))},e.\u0275prov=b.Ib({token:e,factory:e.\u0275fac}),e})();var h=r("eY9e");let m=(()=>{class e{}return e.\u0275mod=b.Kb({type:e}),e.\u0275inj=b.Jb({factory:function(t){return new(t||e)},imports:[[c.c,s.j.forFeature(h.b,h.a),i.b.forFeature([p])]]}),e})()},z1kL:function(e,t,r){"use strict";r.d(t,"a",function(){return n}),r.d(t,"b",function(){return a});var c=r("l7P3"),s=r("ckED");const i=Object(c.o)(s.a),n=Object(c.q)(i,e=>{var t;return null===(t=Object.values(e||{}))||void 0===t?void 0:t.filter(e=>0!==e.id)}),a=({id:e})=>Object(c.q)(i,t=>t[e])}}]);