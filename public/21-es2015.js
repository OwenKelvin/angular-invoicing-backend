(window.webpackJsonp=window.webpackJsonp||[]).push([[21],{CG4G:function(e,t,c){"use strict";c.d(t,"a",function(){return n});const n=(e=class{})=>class extends e{getColorString(e){return["hsl(",Math.floor(120*e/100),",100%,50%)"].join("")}}},U1Ny:function(e,t,c){"use strict";c.r(t),c.d(t,"SalesModule",function(){return ge});var n=c("ofXK"),o=c("tyNb"),i=c("3Pt+"),s=c("2Vo4"),b=c("l7P3"),r=c("nPLa"),a=c("lJxs"),l=c("5+tZ"),u=c("1G5W"),d=c("gJ3R"),m=c("w/e7");const p=[],h=Object(b.p)(p,Object(b.r)(m.d,(e,t)=>{const c=[...e],n=e.filter(({productId:e})=>e===t.data.productId),o=e.indexOf(n[0]);return o>=0?(c[o]=Object.assign(Object.assign({},c[o]),{saleQuantity:Number(n[0].saleQuantity)+Number(t.data.saleQuantity)}),c):[...c,t.data]}),Object(b.r)(m.a,(e,t)=>{const c=[...e],n=e.filter(({productId:e})=>e===t.data.productId),o=e.indexOf(n[0]);return c[o]=Object.assign(Object.assign({},c[o]),{saleQuantity:Math.max(Number(n[0].saleQuantity)+Number(t.data.changeBy),1)}),c}),Object(b.r)(m.c,(e,t)=>e.filter(({productId:e})=>e!==t.data.productId)),Object(b.r)(m.b,()=>p)),S=Object(b.o)("cart"),g=Object(b.q)(S,e=>null==e?void 0:e.length),f=Object(b.q)(S,e=>e.reduce((e,t)=>Number(t.salePrice)*Number(t.saleQuantity)+e,0));var y=c("+Kmi"),R=c("sEf6"),A=c("fXoL"),v=c("2qjx"),I=c("ChtM"),P=c("ZOsW"),M=c("QlUG"),j=c("dZIy");function C(e,t){if(1&e&&(A.Sb(0,"ng-option",34),A.Ac(1),A.cc(2,"titlecase"),A.Rb()),2&e){const e=t.$implicit;A.hc("value",e.id),A.Ab(1),A.Cc(" ",A.dc(2,2,e.name)," ")}}function O(e,t){if(1&e){const e=A.Tb();A.Sb(0,"li",37),A.Zb("click",function(){A.tc(e);const c=t.$implicit;return A.bc(2).saleCurrency.setValue(c)}),A.Sb(1,"span",38),A.Ac(2),A.Rb(),A.Rb()}if(2&e){const e=t.$implicit;A.Ab(2),A.Bc(e)}}function w(e,t){if(1&e&&(A.Sb(0,"ul",35),A.yc(1,O,3,1,"li",36),A.cc(2,"async"),A.Rb()),2&e){const e=A.bc();A.Ab(1),A.hc("ngForOf",A.dc(2,1,e.currencies$))}}function N(e,t){1&e&&(A.Sb(0,"span",39),A.Ac(1,"Item added to cart!"),A.Rb())}let k=(()=>{class e extends(Object(y.a)(Object(R.a)())){constructor(e,t,c,n){super(),this.fb=e,this.productService=t,this.currencyService=c,this.store=n,this.newSaleItemForm=this.fb.group({productId:[null,[i.v.required]],saleQuantity:[1,[i.v.required]],salePrice:[null,[i.v.required]],unitPrice:[null],unitPriceCurrency:["KES"],saleCurrency:["KES",[i.v.required]],searchProduct:[""]}),this.cartAdditionSubject$=new s.a(!1),this.cartAdditionAction$=this.cartAdditionSubject$.asObservable(),this.products$=this.productService.loadProducts$,this.currencies$=this.currencyService.currencies$,this.cartItemsCount$=this.store.pipe(Object(b.t)(g)),this.cartItemsPrice$=this.store.pipe(Object(b.t)(f))}ngOnInit(){var e;this.newSaleItemForm.valueChanges.subscribe({next:()=>this.cartAdditionSubject$.next(!1)}),this.store.dispatch(Object(r.b)()),null===(e=this.newSaleItemForm.get("productId"))||void 0===e||e.valueChanges.pipe(Object(a.a)(e=>Number(e)),Object(l.a)(e=>this.store.pipe(Object(b.t)(Object(d.b)({id:e})))),Object(u.a)(this.destroyed$)).subscribe({next:e=>{var t,c,n,o;null===(t=this.newSaleItemForm.get("unitPrice"))||void 0===t||t.setValue(e.sellingPrice),null===(c=this.newSaleItemForm.get("salePrice"))||void 0===c||c.setValue(e.sellingPrice),null===(n=this.newSaleItemForm.get("saleCurrency"))||void 0===n||n.setValue(e.sellingPriceCurrency),null===(o=this.newSaleItemForm.get("unitPriceCurrency"))||void 0===o||o.setValue(e.sellingPriceCurrency),this.newSaleItemForm.updateValueAndValidity()}})}resetForm(){this.newSaleItemForm.setValue({productId:null,saleQuantity:1,salePrice:null,unitPrice:null,unitPriceCurrency:"KES",saleCurrency:"KES",searchProduct:""}),this.newSaleItemForm.markAsUntouched()}get saleCurrency(){return this.newSaleItemForm.get("saleCurrency")}get unitPriceCurrency(){return this.newSaleItemForm.get("unitPriceCurrency")}newSaleItemFormSubmit(){this.newSaleItemForm.valid&&(this.store.dispatch(Object(m.d)({data:this.newSaleItemForm.value})),this.resetForm(),this.cartAdditionSubject$.next(!0))}closeModal(){this.itemForm=this.newSaleItemForm,this.closeFormDialog()&&this.store.dispatch(Object(r.a)())}}return e.\u0275fac=function(t){return new(t||e)(A.Mb(i.d),A.Mb(v.a),A.Mb(I.a),A.Mb(b.h))},e.\u0275cmp=A.Gb({type:e,selectors:[["app-add-sale-item"]],features:[A.xb],decls:60,vars:20,consts:[[1,"bg-dark"],[3,"formGroup","submit"],[1,"card"],[1,"card-header","d-flex","justify-content-between"],["disabled","","type","button",1,"btn","btn-success"],[1,"icon-cart-plus","mr-3"],[1,"badge","badge-secondary","pt-0"],["type","button",1,"btn","btn-success","ml-2",3,"click"],[1,"icon-ok"],[1,"card-body"],[1,"d-flex","flex-wrap"],[1,"col-lg-6","mt-3"],["for","product",1,"control-label"],["placeholder","Choose a Product","id","product","formControlName","productId"],["role","option",3,"value",4,"ngFor","ngForOf"],["type","number","label","Quantity","placeholder","eg 20","id","purchasePrice","formControlName","saleQuantity"],["for","unitPrice",1,"control-label"],[1,"input-group","mb-3"],[1,"input-group-prepend"],["type","button",1,"btn","bg-light","text-dark"],["readonly","","id","unitPrice","formControlName","unitPrice","type","number",1,"form-control"],["for","salePrice",1,"control-label"],["dropdown","",1,"btn-group"],["id","button-split","type","button","dropdownToggle","","aria-controls","dropdown-split",1,"btn","bg-light","text-dark","dropdown-toggle","dropdown-toggle-split"],[1,"caret"],[1,"sr-only"],["id","dropdown-split","class","dropdown-menu","role","menu","aria-labelledby","button-split",4,"dropdownMenu"],["type","number","id","salePrice","formControlName","salePrice","required","",1,"form-control"],[1,"card-footer","d-flex","justify-content-between"],[1,"btn","btn-primary",3,"disabled"],[1,"icon-cart-plus"],["class","text-success m-2",4,"ngIf"],["type","button",1,"btn","btn-secondary","mr-3",3,"disabled","click"],[1,"icon-cancel"],["role","option",3,"value"],["id","dropdown-split","role","menu","aria-labelledby","button-split",1,"dropdown-menu"],["role","menuitem",3,"click",4,"ngFor","ngForOf"],["role","menuitem",3,"click"],[1,"dropdown-item"],[1,"text-success","m-2"]],template:function(e,t){1&e&&(A.Sb(0,"section",0),A.Sb(1,"form",1),A.Zb("submit",function(){return t.newSaleItemFormSubmit()}),A.Sb(2,"section",2),A.Sb(3,"section",3),A.Sb(4,"h2"),A.Ac(5,"Sale Items"),A.Rb(),A.Sb(6,"span"),A.Sb(7,"button",4),A.Sb(8,"span",5),A.Sb(9,"span",6),A.Ac(10),A.cc(11,"async"),A.Rb(),A.Rb(),A.Ac(12),A.cc(13,"currency"),A.cc(14,"async"),A.Rb(),A.Sb(15,"button",7),A.Zb("click",function(){return t.closeModal()}),A.Nb(16,"span",8),A.Ac(17," View Cart "),A.Rb(),A.Rb(),A.Rb(),A.Sb(18,"section",9),A.Sb(19,"section",10),A.Sb(20,"section",11),A.Sb(21,"label",12),A.Ac(22,"Product"),A.Rb(),A.Sb(23,"ng-select",13),A.yc(24,C,3,4,"ng-option",14),A.cc(25,"async"),A.Rb(),A.Rb(),A.Sb(26,"section",11),A.Nb(27,"app-input",15),A.Rb(),A.Sb(28,"section",11),A.Sb(29,"label",16),A.Ac(30,"Default Selling Price"),A.Rb(),A.Sb(31,"div",17),A.Sb(32,"div",18),A.Sb(33,"button",19),A.Ac(34),A.Rb(),A.Rb(),A.Nb(35,"input",20),A.Rb(),A.Rb(),A.Sb(36,"section",11),A.Sb(37,"label",21),A.Ac(38,"Selling Price"),A.Rb(),A.Sb(39,"div",17),A.Sb(40,"div",18),A.Sb(41,"div",22),A.Sb(42,"button",19),A.Ac(43),A.Rb(),A.Sb(44,"button",23),A.Nb(45,"span",24),A.Sb(46,"span",25),A.Ac(47,"Change Currency"),A.Rb(),A.Rb(),A.yc(48,w,3,3,"ul",26),A.Rb(),A.Rb(),A.Nb(49,"input",27),A.Rb(),A.Rb(),A.Rb(),A.Rb(),A.Sb(50,"section",28),A.Sb(51,"section"),A.Sb(52,"button",29),A.Ac(53," Add To Cart "),A.Nb(54,"span",30),A.Rb(),A.yc(55,N,2,0,"span",31),A.cc(56,"async"),A.Rb(),A.Sb(57,"button",32),A.Zb("click",function(){return t.resetForm()}),A.Nb(58,"span",33),A.Ac(59,"Clear"),A.Rb(),A.Rb(),A.Rb(),A.Rb(),A.Rb()),2&e&&(A.Ab(1),A.hc("formGroup",t.newSaleItemForm),A.Ab(9),A.Bc(A.dc(11,9,t.cartItemsCount$)),A.Ab(2),A.Cc(" Total : ",A.ec(13,11,A.dc(14,14,t.cartItemsPrice$),"KES ")," "),A.Ab(12),A.hc("ngForOf",A.dc(25,16,t.products$)),A.Ab(10),A.Bc(t.unitPriceCurrency.value),A.Ab(9),A.Bc(t.saleCurrency.value),A.Ab(9),A.hc("disabled",t.newSaleItemForm.invalid||!t.newSaleItemForm.dirty),A.Ab(3),A.hc("ngIf",A.dc(56,18,t.cartAdditionAction$)),A.Ab(2),A.hc("disabled",!t.newSaleItemForm.dirty))},directives:[i.x,i.n,i.h,P.a,i.m,i.g,n.m,M.a,i.b,i.q,j.a,j.d,j.b,i.t,n.n,P.c],pipes:[n.b,n.d,n.u],styles:[""]}),e})();var x=c("vkgz"),$=c("B/gT"),F=c("K3ix"),T=c("kOKB"),D=c("tk/3");let Z=(()=>{class e{constructor(e){this.http=e,this.token$=this.http.get("api/m-pesa/access-token"),this.checkPaymentReceipt=({mobileNumber:e,amount:t})=>this.http.get(`api/m-pesa/receipts/?query=${e}&amount=${t}`),this.lipaNaMPesa=({mobileNumber:e})=>this.http.post("api/m-pesa/lipa-na-mpesa",{mobile_number:e})}getAccountBalance(){return this.http.get("api/m-pesa/balance")}simulateError(){return this.http.post("api/m-pesa/callback-url",{})}simulateResult(){return this.http.post("api/m-pesa/callback-url",{Body:{stkCallback:{MerchantRequestID:"4358-8482324-1",CheckoutRequestID:"ws_CO_240620201951034354",ResultCode:0,ResultDesc:"The service request is processed successfully.",CallbackMetadata:{Item:[{Name:"Amount",Value:1},{Name:"MpesaReceiptNumber",Value:"OFO1800ZC1"},{Name:"Balance"},{Name:"TransactionDate",Value:20200624195156},{Name:"PhoneNumber",Value:254712692310}]}}}})}}return e.\u0275fac=function(t){return new(t||e)(A.Wb(D.b))},e.\u0275prov=A.Ib({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();function Q(e,t){if(1&e&&(A.Qb(0),A.Ac(1),A.cc(2,"titlecase"),A.Pb()),2&e){const e=t.ngIf;A.Ab(1),A.Cc(" ",A.dc(2,1,e)," ")}}function q(e,t){if(1&e){const e=A.Tb();A.Sb(0,"tr"),A.Sb(1,"td"),A.Ac(2),A.Rb(),A.Sb(3,"td"),A.yc(4,Q,3,3,"ng-container",38),A.cc(5,"async"),A.Rb(),A.Sb(6,"td"),A.Ac(7),A.cc(8,"currency"),A.Rb(),A.Sb(9,"td"),A.Sb(10,"section",23),A.Sb(11,"span",39),A.Sb(12,"button",40),A.Zb("click",function(){A.tc(e);const c=t.$implicit;return A.bc().changeQuantity(c.productId,-1)}),A.Nb(13,"span",41),A.Rb(),A.Rb(),A.Sb(14,"span",39),A.Ac(15),A.Rb(),A.Sb(16,"span",39),A.Sb(17,"button",42),A.Zb("click",function(){A.tc(e);const c=t.$implicit;return A.bc().changeQuantity(c.productId,1)}),A.Nb(18,"span",4),A.Rb(),A.Rb(),A.Rb(),A.Rb(),A.Sb(19,"td",23),A.Ac(20),A.cc(21,"currency"),A.Rb(),A.Sb(22,"td"),A.Sb(23,"button",43),A.Zb("click",function(){A.tc(e);const c=t.$implicit;return A.bc().removeItem(c.productId)}),A.Nb(24,"span",44),A.Rb(),A.Rb(),A.Rb()}if(2&e){const e=t.$implicit,c=A.bc();A.Ab(2),A.Cc(" #",e.productId," "),A.Ab(2),A.hc("ngIf",A.dc(5,6,c.productName(e.productId))),A.Ab(3),A.Bc(A.ec(8,8,e.salePrice," ")),A.Ab(5),A.hc("disabled",e.saleQuantity<=1),A.Ab(3),A.Bc(e.saleQuantity),A.Ab(5),A.Cc(" ",A.ec(21,11,e.salePrice*e.saleQuantity," ")," ")}}function B(e,t){if(1&e){const e=A.Tb();A.Sb(0,"section",12),A.Sb(1,"label",45),A.Ac(2,"Discount Type"),A.Rb(),A.Sb(3,"select",46),A.Zb("ngModelChange",function(t){return A.tc(e),A.bc().discountType=t}),A.Sb(4,"option",47),A.Ac(5,"Absolute"),A.Rb(),A.Sb(6,"option",48),A.Ac(7,"Percentage"),A.Rb(),A.Rb(),A.Rb()}if(2&e){const e=A.bc();A.Ab(3),A.hc("ngModel",e.discountType)}}function K(e,t){if(1&e){const e=A.Tb();A.Sb(0,"section",12),A.Sb(1,"label",49),A.Ac(2,"Discount Value"),A.Rb(),A.Sb(3,"input",50),A.Zb("ngModelChange",function(t){return A.tc(e),A.bc().discountAmount=t}),A.Rb(),A.Rb()}if(2&e){const e=A.bc();A.Ab(3),A.hc("ngModel",e.discountAmount)}}function E(e,t){if(1&e&&(A.Sb(0,"section",19),A.Sb(1,"section",20),A.Ac(2," Discount Amount "),A.Rb(),A.Sb(3,"section",21),A.Ac(4),A.Rb(),A.Rb()),2&e){const e=A.bc();A.Ab(4),A.Cc(" ",e.discountNetAmount," ")}}function V(e,t){if(1&e){const e=A.Tb();A.Sb(0,"div",51),A.Sb(1,"div",52),A.Sb(2,"label",53),A.Ac(3,"Cash Received"),A.Rb(),A.Sb(4,"input",54),A.Zb("ngModelChange",function(t){return A.tc(e),A.bc().cashReceived=t}),A.Rb(),A.Rb(),A.Sb(5,"div",20),A.Ac(6),A.cc(7,"currency"),A.Rb(),A.Rb()}if(2&e){const e=A.bc();A.Ab(4),A.hc("ngModel",e.cashReceived),A.Ab(2),A.Cc(" Change ",A.ec(7,2,e.cashReceived-(e.cartItemsTotal-e.discountNetAmount),"KES ")," ")}}function G(e,t){if(1&e){const e=A.Tb();A.Sb(0,"div",51),A.Sb(1,"div",52),A.Sb(2,"label",53),A.Ac(3,"Creditor Phone Number"),A.Rb(),A.Sb(4,"input",55),A.Zb("ngModelChange",function(t){return A.tc(e),A.bc().creditorPhoneNumber=t}),A.Rb(),A.Rb(),A.Rb()}if(2&e){const e=A.bc();A.Ab(4),A.hc("ngModel",e.creditorPhoneNumber)}}function X(e,t){if(1&e){const e=A.Tb();A.Sb(0,"div",51),A.Sb(1,"div",52),A.Sb(2,"label",53),A.Ac(3,"M-Pesa Phone Number"),A.Rb(),A.Sb(4,"input",56),A.Zb("ngModelChange",function(t){return A.tc(e),A.bc().mPesaPhoneNumber=t}),A.Rb(),A.Rb(),A.Sb(5,"div"),A.Sb(6,"button",57),A.Zb("click",function(){return A.tc(e),A.bc().sendMpesaPaymentRequest()}),A.Ac(7,"Send Payment Request"),A.Rb(),A.Sb(8,"button",35),A.Zb("click",function(){return A.tc(e),A.bc().checkPaymentReceipt()}),A.Ac(9,"Check "),A.Rb(),A.Rb(),A.Rb()}if(2&e){const e=A.bc();A.Ab(4),A.hc("ngModel",e.mPesaPhoneNumber),A.Ab(2),A.hc("disabled",e.amountDue<=0),A.Ab(2),A.hc("disabled",e.amountDue<=0)}}function J(e,t){1&e&&A.Nb(0,"i",58)}function L(e,t){1&e&&A.Nb(0,"i",59)}let U=(()=>{class e extends(Object($.a)(Object(R.a)(Object(y.a)()))){constructor(e,t,c,n){super(),this.store=e,this.modalService=t,this.saleService=c,this.mPesaService=n,this.cashReceived=0,this.paymentMethod="cash",this.isDiscounted=!1,this.discountAmount=0,this.discountType="percentage",this.cartItems$=this.store.pipe(Object(b.t)(S),Object(x.a)(e=>this.cartItems=e)),this.cartItemsTotal$=this.store.pipe(Object(b.t)(f),Object(x.a)(e=>this.cartItemsTotal=e)),this.productName=e=>this.store.pipe(Object(b.t)(Object(d.b)({id:e})),Object(a.a)(e=>e.name)),this.storeInjected=this.store,this.modalServiceInjected=this.modalService}ngOnInit(){this.mPesaService.getAccountBalance().subscribe(e=>console.log({res:e}))}get discountNetAmount(){return this.isDiscounted&&"absolute"===this.discountType?Number(this.discountAmount):this.isDiscounted&&"percentage"===this.discountType?Number(this.cartItemsTotal)*Number(this.discountAmount)/100:0}sendMpesaPaymentRequest(){this.mPesaService.lipaNaMPesa({mobileNumber:this.mPesaPhoneNumber}).subscribe({next:e=>{console.log(e)}})}checkPaymentReceipt(){alert(this.mPesaPhoneNumber),this.mPesaService.checkPaymentReceipt({amount:this.amountDue,mobileNumber:this.mPesaPhoneNumber}).subscribe({next:e=>{console.log(e)}})}get amountDue(){return this.cartItemsTotal-this.discountNetAmount}changeQuantity(e,t){this.store.dispatch(Object(m.a)({data:{productId:e,changeBy:t}}))}removeItem(e){this.store.dispatch(Object(m.c)({data:{productId:e}}))}addItems(){this.openModal({id:0,component:k})}submitCart(){this.submitInProgressSubject$.next(!0),this.saleService.saveSale({discount:{type:this.discountType,amount:this.discountAmount},products:this.cartItems,payment:{method:this.paymentMethod,amountReceived:this.cashReceived}}).subscribe({next:()=>{this.submitInProgressSubject$.next(!1),this.isDiscounted=!1,this.discountType="percentage",this.discountAmount=0,this.paymentMethod="cash",this.cashReceived=0},error:()=>this.submitInProgressSubject$.next(!1)})}canDeactivate(){return confirm("You are exiting the sales page, continue?")}ngOnDestroy(){var e;super.ngOnDestroy(),null===(e=this.modalRef)||void 0===e||e.hide()}}return e.\u0275fac=function(t){return new(t||e)(A.Mb(b.h),A.Mb(F.a),A.Mb(T.a),A.Mb(Z))},e.\u0275cmp=A.Gb({type:e,selectors:[["app-sale-summary"]],features:[A.xb],decls:87,vars:30,consts:[[1,"card","p-2"],[1,"card-header","mb-1","pt-1","pl-2"],[1,"d-flex","justify-content-between"],[1,"btn","btn-primary",3,"click"],[1,"icon-plus-circled"],[1,"table","table-dark"],[1,"text-center"],[4,"ngFor","ngForOf"],["colspan","5"],["colspan","4"],[1,"card","p-2","mt-2"],[1,"d-flex","flex-wrap"],[1,"col-lg-3"],[1,"custom-control","custom-switch","mt-3"],["type","checkbox","id","apply-discount",1,"custom-control-input",3,"ngModel","ngModelChange"],["for","apply-discount",1,"custom-control-label"],["class","col-lg-3",4,"ngIf"],[1,"d-flex","flex-wrap","mt-3","p-3","pb-4"],["class","col-lg-12 d-flex justify-content-end mt-2",4,"ngIf"],[1,"col-lg-12","d-flex","justify-content-end","mt-2"],[1,"col-lg-4"],[1,"col-lg-2"],[1,"card","p-2","mt-2",2,"position","relative"],[1,"d-flex","flex-wrap","justify-content-between"],[1,"col-lg-6","mt-2","mb-2","d-flex","justify-content-between"],[1,"custom-control","custom-radio"],["value","cash","type","radio","id","payment-method-cash",1,"custom-control-input",3,"ngModel","ngModelChange"],["for","payment-method-cash",1,"custom-control-label"],["disabled","","value","on-credit","type","radio","id","payment-method-on-credit",1,"custom-control-input",3,"ngModel","ngModelChange"],["for","payment-method-on-credit",1,"custom-control-label"],["value","m-pesa","type","radio","id","payment-method-m-pesa",1,"custom-control-input",3,"ngModel","ngModelChange"],["for","payment-method-m-pesa",1,"custom-control-label"],["class","col-lg-8 d-flex justify-content-between align-items-end",4,"ngIf"],[1,"d-flex","mt-2"],[1,"col-lg-12","d-flex","justify-content-end"],["type","button",1,"btn","btn-success",3,"disabled","click"],["class","icon-ok",4,"ngIf"],["class","icon-spin3 animate-spin",4,"ngIf"],[4,"ngIf"],[1,"col-sm-12","col-md-12","col-lg-3","text-center"],["aria-label","Reduce Quantity",1,"btn","btn-secondary","btn-sm",3,"disabled","click"],[1,"icon-minus-circled"],["aria-label","Reduce Quantity",1,"btn","btn-secondary","btn-sm",3,"click"],["aria-label","Remove",1,"btn","btn-danger","btn-sm",3,"click"],[1,"icon-cancel-circled"],["for","discountType"],["id","discountType",1,"custom-select",3,"ngModel","ngModelChange"],["selected","","value","absolute"],["value","percentage"],["for","discountAmount"],["id","discountAmount",1,"form-control",3,"ngModel","ngModelChange"],[1,"col-lg-8","d-flex","justify-content-between","align-items-end"],[1,"col-lg-5","p-0"],["for","cashReceived"],["type","text","id","cashReceived",1,"form-control",3,"ngModel","ngModelChange"],["type","text","id","creditorPhoneNumber",1,"form-control",3,"ngModel","ngModelChange"],["type","tel","placeholder","2547XXXXXXXX","type","text","id","creditorPhoneNumber",1,"form-control",3,"ngModel","ngModelChange"],["type","button",1,"btn","btn-primary","mr-2",3,"disabled","click"],[1,"icon-ok"],[1,"icon-spin3","animate-spin"]],template:function(e,t){1&e&&(A.Sb(0,"h1"),A.Ac(1,"Sale"),A.Rb(),A.Sb(2,"section"),A.Sb(3,"div",0),A.Sb(4,"h2",1),A.Ac(5,"Items in Cart"),A.Rb(),A.Sb(6,"section",2),A.Sb(7,"button",3),A.Zb("click",function(){return t.addItems()}),A.Sb(8,"span",4),A.Ac(9,"Add Item"),A.Rb(),A.Rb(),A.Rb(),A.Sb(10,"table",5),A.Sb(11,"thead"),A.Sb(12,"tr"),A.Sb(13,"th"),A.Ac(14,"Product Id"),A.Rb(),A.Sb(15,"th"),A.Ac(16,"Product Name"),A.Rb(),A.Sb(17,"th"),A.Ac(18,"Price Per Unit"),A.Rb(),A.Sb(19,"th",6),A.Ac(20,"Quantity"),A.Rb(),A.Sb(21,"th"),A.Ac(22,"Total"),A.Rb(),A.Rb(),A.Rb(),A.Sb(23,"tbody"),A.yc(24,q,25,14,"tr",7),A.cc(25,"async"),A.Sb(26,"tr"),A.Sb(27,"td",8),A.Ac(28,"\xa0"),A.Rb(),A.Rb(),A.Sb(29,"tr"),A.Sb(30,"td",9),A.Sb(31,"strong"),A.Ac(32,"TOTAL"),A.Rb(),A.Rb(),A.Sb(33,"td"),A.Ac(34),A.cc(35,"currency"),A.cc(36,"async"),A.Rb(),A.Rb(),A.Rb(),A.Rb(),A.Rb(),A.Sb(37,"div",10),A.Sb(38,"h2",1),A.Ac(39,"Discount"),A.Rb(),A.Sb(40,"section",11),A.Sb(41,"section",12),A.Sb(42,"div",13),A.Sb(43,"input",14),A.Zb("ngModelChange",function(e){return t.isDiscounted=e}),A.Rb(),A.Sb(44,"label",15),A.Ac(45," Apply Discount "),A.Rb(),A.Rb(),A.Rb(),A.yc(46,B,8,1,"section",16),A.yc(47,K,4,1,"section",16),A.Rb(),A.Rb(),A.Sb(48,"div",10),A.Sb(49,"h2",1),A.Ac(50,"Summary"),A.Rb(),A.Sb(51,"section",17),A.yc(52,E,5,1,"section",18),A.Sb(53,"section",19),A.Sb(54,"section",20),A.Ac(55," Total Amount Due "),A.Rb(),A.Sb(56,"section",21),A.Ac(57),A.cc(58,"currency"),A.Rb(),A.Rb(),A.Rb(),A.Rb(),A.Sb(59,"div",22),A.Sb(60,"h2",1),A.Ac(61,"Payment Method"),A.Rb(),A.Sb(62,"div",23),A.Sb(63,"div",24),A.Sb(64,"div",25),A.Sb(65,"input",26),A.Zb("ngModelChange",function(e){return t.paymentMethod=e}),A.Rb(),A.Sb(66,"label",27),A.Ac(67,"Cash"),A.Rb(),A.Rb(),A.Sb(68,"div",25),A.Sb(69,"input",28),A.Zb("ngModelChange",function(e){return t.paymentMethod=e}),A.Rb(),A.Sb(70,"label",29),A.Ac(71,"On Credit"),A.Rb(),A.Rb(),A.Sb(72,"div",25),A.Sb(73,"input",30),A.Zb("ngModelChange",function(e){return t.paymentMethod=e}),A.Rb(),A.Sb(74,"label",31),A.Ac(75,"M - PESA"),A.Rb(),A.Rb(),A.Rb(),A.yc(76,V,8,5,"div",32),A.yc(77,G,5,1,"div",32),A.yc(78,X,10,3,"div",32),A.Rb(),A.Rb(),A.Rb(),A.Sb(79,"section",33),A.Sb(80,"section",34),A.Sb(81,"button",35),A.Zb("click",function(){return t.submitCart()}),A.Ac(82," Submit "),A.yc(83,J,1,0,"i",36),A.cc(84,"async"),A.yc(85,L,1,0,"i",37),A.cc(86,"async"),A.Rb(),A.Rb(),A.Rb()),2&e&&(A.Ab(24),A.hc("ngForOf",A.dc(25,16,t.cartItems$)),A.Ab(10),A.Bc(A.ec(35,18,A.dc(36,21,t.cartItemsTotal$),"KES ")),A.Ab(9),A.hc("ngModel",t.isDiscounted),A.Ab(3),A.hc("ngIf",t.isDiscounted),A.Ab(1),A.hc("ngIf",t.isDiscounted),A.Ab(5),A.hc("ngIf",t.isDiscounted),A.Ab(5),A.Cc(" ",A.ec(58,23,t.amountDue,"KES ")," "),A.Ab(8),A.hc("ngModel",t.paymentMethod),A.Ab(4),A.hc("ngModel",t.paymentMethod),A.Ab(4),A.hc("ngModel",t.paymentMethod),A.Ab(3),A.hc("ngIf","cash"===t.paymentMethod),A.Ab(1),A.hc("ngIf","on-credit"===t.paymentMethod),A.Ab(1),A.hc("ngIf","m-pesa"===t.paymentMethod),A.Ab(3),A.hc("disabled",t.cartItemsTotal<=0),A.Ab(2),A.hc("ngIf",!1===A.dc(84,26,t.submitInProgressAction$)),A.Ab(2),A.hc("ngIf",A.dc(86,28,t.submitInProgressAction$)))},directives:[n.m,i.a,i.m,i.o,n.n,i.r,i.b,i.u,i.p,i.w],pipes:[n.b,n.d,n.u],styles:[".button-group[_ngcontent-%COMP%]   .btn-success[_ngcontent-%COMP%]{pointer-events:none}"],changeDetection:0}),e})();var _=c("E3ii"),W=c("Mo0h");const Y=[{path:"",pathMatch:"full",data:{breadcrumb:null},component:(()=>{class e{constructor(e){this.linkService=e,this.links$=this.linkService.salesLinks$}}return e.\u0275fac=function(t){return new(t||e)(A.Mb(_.a))},e.\u0275cmp=A.Gb({type:e,selectors:[["app-sales"]],decls:3,vars:1,consts:[[3,"links$"]],template:function(e,t){1&e&&(A.Sb(0,"h1"),A.Ac(1,"Sales"),A.Rb(),A.Nb(2,"app-links",0)),2&e&&(A.Ab(2),A.hc("links$",t.links$))},directives:[W.a],styles:[""]}),e})()},{path:"make-sale",data:{breadcrumb:"Make Sale"},component:U,canDeactivate:[c("wNMA").a]},{path:"edit-sale",data:{breadcrumb:"Edit Sale"},loadChildren:()=>Promise.all([c.e(6),c.e(0),c.e(26)]).then(c.bind(null,"aPer")).then(e=>e.EditSoldProductsModule)}];let z=(()=>{class e{}return e.\u0275mod=A.Kb({type:e}),e.\u0275inj=A.Jb({factory:function(t){return new(t||e)},imports:[[o.j.forChild(Y)],o.j]}),e})();const H=Object(b.n)("[Sale] Load Sales"),ee=Object(b.n)("[Sale] Load Sales Success",Object(b.s)()),te=Object(b.n)("[Sale] Load Sales Failure",Object(b.s)()),ce=Object(b.p)({},Object(b.r)(H,e=>e),Object(b.r)(ee,e=>e),Object(b.r)(te,e=>e));var ne=c("9jGm"),oe=c("bOdf"),ie=c("JIr8"),se=c("EY2u"),be=c("LRne");let re=(()=>{class e{constructor(e){this.actions$=e,this.loadSales$=Object(ne.c)(()=>this.actions$.pipe(Object(ne.d)(H),Object(oe.a)(()=>se.a.pipe(Object(a.a)(e=>ee({data:e})),Object(ie.a)(e=>Object(be.a)(te({error:e})))))))}}return e.\u0275fac=function(t){return new(t||e)(A.Wb(ne.a))},e.\u0275prov=A.Ib({token:e,factory:e.\u0275fac}),e})(),ae=(()=>{class e{}return e.\u0275mod=A.Kb({type:e}),e.\u0275inj=A.Jb({factory:function(t){return new(t||e)},imports:[[n.c,b.j.forFeature("sale",ce),ne.b.forFeature([re])]]}),e})();var le=c("RecK"),ue=c("HEfn"),de=c("IVO7"),me=c("MPUB"),pe=c("X/30"),he=c("jdGB"),Se=c("Yg/+");let ge=(()=>{class e{}return e.\u0275mod=A.Kb({type:e}),e.\u0275inj=A.Jb({factory:function(t){return new(t||e)},imports:[[n.c,z,ae,le.a,F.b.forRoot(),i.j,i.s,j.c.forRoot(),b.j.forFeature("cart",h),ue.a,de.a,me.a,pe.a,he.a,P.b,Se.a]]}),e})()},e6Kq:function(e,t,c){"use strict";c.d(t,"a",function(){return n});const n=(e=class{})=>class extends e{getDate(e){e.setHours(-e.getTimezoneOffset()/60,0,0);const[t,c,n]=e.toISOString().split("-");return`${t}-${c}-${n.substr(0,2)}`}}}}]);